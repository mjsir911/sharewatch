<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>test</title>
<style type="text/css">
</style>
</head>
<body>
	<form onsubmit="vid.src = vUrl.value; return false">
		<input id="vUrl">
		<input type="submit">
	</form>
	<video id="vid"
	       controls
	         onplay="ws.send(JSON.stringify({'event': event.type}))"
	        onpause="ws.send(JSON.stringify({'event': event.type}))"
	       onseeked="ws.send(JSON.stringify({'event': 'seek', 'args': [vid.currentTime]}))"
	></video>
	<script type="text/javascript">
		vid.seek = function(time) {
			if (Math.abs(time - vid.currentTime) > 1) {
				vid.currentTime = time
			}
		}
		var ws = new WebSocket('ws://' + window.location.host + '/ws')
		ws.addEventListener('message', e => {
			payload = JSON.parse(e.data)
			console.log(payload);
			args = payload["args"] || []
			console.log(args);
			vid[payload["event"]](...args)
		})
	</script>
</body>
</html>
